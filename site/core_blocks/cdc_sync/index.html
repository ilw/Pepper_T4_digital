
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../fifo/" rel="prev"/>
<link href="../../functional/status_logic/" rel="next"/>
<link href="../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.7.1" name="generator"/>
<title>CDC Sync - Pepper_T4 Digital Documentation</title>
<link href="../../assets/stylesheets/main.484c7ddc.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#cdc_sync-module-documentation">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Pepper_T4 Digital Documentation" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Pepper_T4 Digital Documentation">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Pepper_T4 Digital Documentation
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              CDC Sync
            
          </span>
</div>
</div>
</div>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<a aria-label="Share" class="md-search__icon md-icon" data-clipboard="" data-clipboard-text="" data-md-component="search-share" href="javascript:void(0)" tabindex="-1" title="Share">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg>
</a>
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../..">
        
  
  
    
  
  Home

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../system_overview/">
          
  
  
  System Overview

        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../command_interpreter/">
          
  
  
  Core Blocks

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../functional/status_logic/">
          
  
  
  Functional Logic

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../peripherals/atm_control/">
          
  
  
  Peripherals

        </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Pepper_T4 Digital Documentation" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Pepper_T4 Digital Documentation">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
    Pepper_T4 Digital Documentation
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
<span class="md-ellipsis">
    
  
    Home
  

    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-ellipsis">
    
  
    System Overview
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            
  
    System Overview
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../system_overview/">
<span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../system_overview/block_diagram/">
<span class="md-ellipsis">
    
  
    Block Diagram
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
<span class="md-ellipsis">
    
  
    Core Blocks
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            
  
    Core Blocks
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../command_interpreter/">
<span class="md-ellipsis">
    
  
    Command Interpreter
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../fifo/">
<span class="md-ellipsis">
    
  
    FIFO
  

    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    
  
    CDC Sync
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    
  
    CDC Sync
  

    
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#overview">
<span class="md-ellipsis">
      
        Overview
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#synchronization-mechanisms">
<span class="md-ellipsis">
      
        Synchronization Mechanisms
      
    </span>
</a>
<nav aria-label="Synchronization Mechanisms" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-standard-2-flip-flop-synchronizer-level-synchronization">
<span class="md-ellipsis">
      
        1. Standard 2-Flip-Flop Synchronizer (Level Synchronization)
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-toggle-to-pulse-converter">
<span class="md-ellipsis">
      
        2. Toggle-to-Pulse Converter
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-asynchronous-assert-synchronous-deassert-reset">
<span class="md-ellipsis">
      
        3. Asynchronous Assert, Synchronous Deassert (Reset)
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#4-direct-pass-through-area-optimization">
<span class="md-ellipsis">
      
        4. Direct Pass-Through (Area Optimization)
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#timing-constraints">
<span class="md-ellipsis">
      
        Timing Constraints
      
    </span>
</a>
<nav aria-label="Timing Constraints" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#input-pulse-width-requirements">
<span class="md-ellipsis">
      
        Input Pulse Width Requirements
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#level-synchronizer-constraints">
<span class="md-ellipsis">
      
        Level Synchronizer Constraints
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#block-diagram">
<span class="md-ellipsis">
      
        Block Diagram
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Functional Logic
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            
  
    Functional Logic
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../functional/status_logic/">
<span class="md-ellipsis">
    
  
    Status Logic
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Peripherals
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            
  
    Peripherals
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../peripherals/atm_control/">
<span class="md-ellipsis">
    
  
    ATM Control
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../peripherals/configuration_registers/">
<span class="md-ellipsis">
    
  
    Configuration Registers
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../peripherals/temp_sense/">
<span class="md-ellipsis">
    
  
    Temperature Sensor
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#overview">
<span class="md-ellipsis">
      
        Overview
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#synchronization-mechanisms">
<span class="md-ellipsis">
      
        Synchronization Mechanisms
      
    </span>
</a>
<nav aria-label="Synchronization Mechanisms" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-standard-2-flip-flop-synchronizer-level-synchronization">
<span class="md-ellipsis">
      
        1. Standard 2-Flip-Flop Synchronizer (Level Synchronization)
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-toggle-to-pulse-converter">
<span class="md-ellipsis">
      
        2. Toggle-to-Pulse Converter
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-asynchronous-assert-synchronous-deassert-reset">
<span class="md-ellipsis">
      
        3. Asynchronous Assert, Synchronous Deassert (Reset)
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#4-direct-pass-through-area-optimization">
<span class="md-ellipsis">
      
        4. Direct Pass-Through (Area Optimization)
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#timing-constraints">
<span class="md-ellipsis">
      
        Timing Constraints
      
    </span>
</a>
<nav aria-label="Timing Constraints" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#input-pulse-width-requirements">
<span class="md-ellipsis">
      
        Input Pulse Width Requirements
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#level-synchronizer-constraints">
<span class="md-ellipsis">
      
        Level Synchronizer Constraints
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#block-diagram">
<span class="md-ellipsis">
      
        Block Diagram
      
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="cdc_sync-module-documentation">CDC_sync Module Documentation</h1>
<h2 id="overview">Overview</h2>
<p>The <code>CDC_sync</code> module provides <strong>Clock Domain Crossing (CDC) synchronization</strong> for signals crossing from the SPI clock domain (or other source domains) into the high-frequency clock domain (<code>HF_CLK</code>). It implements multiple synchronization strategies tailored to different signal types and timing requirements.</p>
<p><strong>File Location:</strong> <a href="file:///c:/Users/ian_l/Dropbox%20%28UK%20Dementia%20Research%20Institute%29/Box%20Sync/MINT/Design/Verilog/Pepper_T4/code/source/CDC_sync.v">CDC_sync.v</a></p>
<hr/>
<h2 id="synchronization-mechanisms">Synchronization Mechanisms</h2>
<h3 id="1-standard-2-flip-flop-synchronizer-level-synchronization">1. Standard 2-Flip-Flop Synchronizer (Level Synchronization)</h3>
<p>Most control signals use a <strong>2-stage flip-flop synchronizer</strong> chain, which is the industry-standard approach for synchronizing level signals across clock domains.</p>
<p><strong>Signals using this mechanism:</strong>
- <code>ENSAMP</code> → <code>ENSAMP_sync</code>
- <code>ENLOWPWR</code> → <code>ENLOWPWR_sync</code>
- <code>ENMONTSENSE</code> → <code>ENMONTSENSE_sync</code>
- <code>ADCOVERFLOW</code> → <code>ADCOVERFLOW_sync</code>
- <code>ADCOVERFLOW</code> → <code>ADCOVERFLOW_sync</code>
- <code>CFG_CHNGE</code> → <code>CFG_CHNGE_sync</code> <em>(Conditional: enabled via <code>ENABLE_REGISTER_CRC</code>)</em>
- <code>AFERSTCH[7:0]</code> → <code>AFERSTCH_sync[7:0]</code>
- <code>AFERSTCH[7:0]</code> → <code>AFERSTCH_sync[7:0]</code>
- <code>SATDETECT[7:0]</code> → <code>SATDETECT_sync[7:0]</code></p>
<p><strong>How it works:</strong>
<pre class="mermaid"><code>graph LR
    A[Input Signal&lt;br/&gt;Source Domain] --&gt; B[DFF Stage 1&lt;br/&gt;Metastability Filter]
    B --&gt; C[DFF Stage 2&lt;br/&gt;Stable Output]
    C --&gt; D[Synchronized Output&lt;br/&gt;Destination Domain]

    style B fill:#ff9,stroke:#333,stroke-width:2px
    style C fill:#9f9,stroke:#333,stroke-width:2px</code></pre></p>
<p>The first flip-flop may enter a metastable state, but the second flip-flop resolves this to a stable logic level before the signal is used. This provides reliable level synchronization with 2 clock cycles of latency.</p>
<h3 id="2-toggle-to-pulse-converter">2. Toggle-to-Pulse Converter</h3>
<p>The FIFO overflow and underflow signals use a special <strong>toggle synchronization</strong> approach followed by edge detection to generate single-cycle pulses in the destination domain.</p>
<p><strong>Signals using this mechanism:</strong>
- <code>FIFO_OVERFLOW</code> → <code>FIFO_OVERFLOW_sync</code>
- <code>FIFO_UNDERFLOW</code> → <code>FIFO_UNDERFLOW_sync</code></p>
<p><strong>How it works:</strong></p>
<p>The source domain toggles the signal for each event. The destination domain:
1. Synchronizes the toggling signal through a 2-FF chain
2. Compares current value with previous value (XOR operation)
3. Generates a <strong>1-cycle pulse</strong> on each detected edge</p>
<pre class="mermaid"><code>graph LR
    A[Toggle Input&lt;br/&gt;Source Domain] --&gt; B[DFF Stage 1]
    B --&gt; C[DFF Stage 2]
    C --&gt; D[XOR]
    E[Previous Value] --&gt; D
    D --&gt; F[1-Cycle Pulse Output]
    C --&gt; E

    style D fill:#f99,stroke:#333,stroke-width:2px
    style F fill:#9f9,stroke:#333,stroke-width:2px</code></pre>
<p>This approach allows events in a slow source domain to be reliably captured in a fast destination domain, even if multiple events occur between destination clock edges.</p>
<h3 id="3-asynchronous-assert-synchronous-deassert-reset">3. Asynchronous Assert, Synchronous Deassert (Reset)</h3>
<p>The reset signal <code>NRST</code> uses a special CDC technique appropriate for reset signals:
- <strong>Asynchronous assertion</strong>: When <code>NRST</code> goes low, the synchronized reset immediately goes low
- <strong>Synchronous deassertion</strong>: When <code>NRST</code> goes high, it's synchronized through 2 FFs before releasing reset</p>
<p>This ensures reset is applied immediately but released cleanly without metastability.</p>
<h3 id="4-direct-pass-through-area-optimization">4. Direct Pass-Through (Area Optimization)</h3>
<p>Some configuration buses are <strong>not synchronized</strong> and passed directly through:
- <code>PHASE1DIV1[11:0]</code>
- <code>PHASE1COUNT[3:0]</code>
- <code>PHASE2COUNT[9:0]</code>
- <code>CHEN[7:0]</code>
- <code>ADCOSR[3:0]</code></p>
<blockquote>
<p>[!CAUTION]
<strong>Multi-bit CDC Hazard!</strong></p>
<p>These signals are passed through without synchronization to save area. The system <strong>MUST</strong> ensure these configuration registers are only modified when <code>ENSAMP</code> is low (sampling disabled). Changing multi-bit values during operation can cause incorrect intermediate values to be sampled due to skew between bits.</p>
</blockquote>
<hr/>
<h2 id="timing-constraints">Timing Constraints</h2>
<h3 id="input-pulse-width-requirements">Input Pulse Width Requirements</h3>
<blockquote>
<p>[!WARNING]
<strong>Critical Timing Constraint for Toggle Synchronization</strong></p>
<p>For the <code>FIFO_OVERFLOW</code> and <code>FIFO_UNDERFLOW</code> toggle-based synchronizers to guarantee event capture, the input signal must maintain each toggle state for a minimum duration to ensure it is sampled by the destination clock.</p>
<p><strong>Minimum Pulse Width Rule:</strong>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a>T_input_stable ≥ T_dest_clk + T_setup + T_meta
</code></pre></div></p>
<p>Where:
- <code>T_input_stable</code> = Duration the input toggle state must remain stable
- <code>T_dest_clk</code> = Destination clock period (HF_CLK)
- <code>T_setup</code> = Setup time of the destination flip-flops
- <code>T_meta</code> = Metastability resolution time allowance</p>
<p><strong>Practical Rule:</strong> The input should remain stable for <strong>at least 1.5× to 2× the destination clock period</strong> to guarantee reliable capture.</p>
<p><strong>Example:</strong> If <code>HF_CLK</code> = 1 MHz (1 us period), the FIFO overflow/underflow toggle should remain in each state for <strong>≥ 1.5-2 us</strong> minimum.</p>
</blockquote>
<h3 id="level-synchronizer-constraints">Level Synchronizer Constraints</h3>
<p>For the standard 2-FF synchronizers (<code>ENSAMP</code>, <code>ENLOWPWR</code>, etc.):</p>
<p><strong>Input Stability Requirement:</strong>
- Level signals should be <strong>quasi-static</strong> (change infrequently relative to destination clock)
- Signal must remain stable for at least one full destination clock cycle to guarantee capture
- Faster changes may be captured with variable latency (2-3 destination clock cycles)</p>
<blockquote>
<p>[!IMPORTANT]
Multi-bit buses like <code>AFERSTCH[7:0]</code> and <code>SATDETECT[7:0]</code> are synchronized bit-independently. To avoid capturing intermediate values during transitions:
- Keep these buses stable for multiple destination clock cycles when changing
- Use gray-code encoding if values must change rapidly
- OR ensure the source domain changes bits simultaneously (same clock edge)</p>
</blockquote>
<hr/>
<h2 id="block-diagram">Block Diagram</h2>
<pre class="mermaid"><code>graph TB
    subgraph "Inputs - Source Domain"
        IN1[ENSAMP]
        IN2[ENLOWPWR]
        IN3[AFERSTCH 7:0]
        IN4[FIFO_OVERFLOW]
        IN5[FIFO_UNDERFLOW]
        IN6[NRST]
        IN8[CFG_CHNGE]
        IN7[PHASE1DIV1 11:0&lt;br/&gt;Direct Pass-through]
    end

    subgraph "2-FF Level Synchronizers"
        FF1[DFF] --&gt; FF2[DFF]
        FF3[DFF] --&gt; FF4[DFF]
        FF5[DFF] --&gt; FF6[DFF]
        FF7[DFF] --&gt; FF8[DFF]
    end

    subgraph "Toggle-to-Pulse"
        TG1[DFF] --&gt; TG2[DFF]
        TG3[DFF] --&gt; TG4[DFF]
        TG2 --&gt; XOR1[XOR with&lt;br/&gt;Previous]
        TG4 --&gt; XOR2[XOR with&lt;br/&gt;Previous]
    end

    subgraph "Reset Synchronizer"
        RST1[DFF&lt;br/&gt;Async Reset] --&gt; RST2[DFF&lt;br/&gt;Async Reset]
    end

    subgraph "Outputs - HF_CLK Domain"
        OUT1[ENSAMP_sync]
        OUT2[ENLOWPWR_sync]
        OUT3[AFERSTCH_sync 7:0]
        OUT4[FIFO_OVERFLOW_sync&lt;br/&gt;1-cycle pulse]
        OUT5[FIFO_UNDERFLOW_sync&lt;br/&gt;1-cycle pulse]
        OUT6[NRST_sync]
        OUT8[CFG_CHNGE_sync]
        OUT7[PHASE1DIV1_sync 11:0&lt;br/&gt;Direct]
    end

    subgraph "Conditional (ENABLE_REGISTER_CRC)"
        IN8[CFG_CHNGE] --&gt; FF7
        FF8 --&gt; OUT8[CFG_CHNGE_sync]
    end

    IN1 --&gt; FF1
    IN2 --&gt; FF3
    IN3 --&gt; FF5
    IN4 --&gt; TG1
    IN5 --&gt; TG3
    IN6 --&gt; RST1
    IN7 -.-&gt; OUT7

    FF2 --&gt; OUT1
    FF4 --&gt; OUT2
    FF6 --&gt; OUT3
    XOR1 --&gt; OUT4
    XOR2 --&gt; OUT5
    RST2 --&gt; OUT6

    CLK[HF_CLK] -.-&gt; FF1
    CLK -.-&gt; FF2
    CLK -.-&gt; FF3
    CLK -.-&gt; FF4
    CLK -.-&gt; FF5
    CLK -.-&gt; FF6
    CLK -.-&gt; FF7
    CLK -.-&gt; FF8
    CLK -.-&gt; TG1
    CLK -.-&gt; TG2
    CLK -.-&gt; TG3
    CLK -.-&gt; TG4
    CLK -.-&gt; RST1
    CLK -.-&gt; RST2

    style FF1 fill:#ffe,stroke:#333
    style FF2 fill:#efe,stroke:#333
    style FF7 fill:#ddd,stroke:#333,stroke-dasharray: 5 5
    style FF8 fill:#ddd,stroke:#333,stroke-dasharray: 5 5
    style TG1 fill:#ffe,stroke:#333
    style TG2 fill:#fee,stroke:#333
    style XOR1 fill:#fcc,stroke:#333,stroke-width:2px
    style RST1 fill:#eef,stroke:#333</code></pre>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "search.highlight", "search.share"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
<script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
<script src="../../js/wavedrom.unpkg.js"></script>
<script src="../../js/skin-default.js"></script>
</body>
</html>